#!/bin/bash
#
# lock - blur wallpaper and use it as i3lock background
# Sorbet, http://github.com/Sorebit

# Wallpaper dir
wpd="$HOME/.wallpapers"

# Blurred wallpaper directory
bpd="$wpd/.blur-wall"
mkdir -p $bpd

# Get wallpaper name
bg=$(cat $HOME/.fehbg | sed -n 2p | awk '{print $3}')
bg=$(echo $bg | cut -c 2-$[${#bg} - 1])

# Get blurred wallpaper name
bl=$(echo $bg | sed "s|$wpd|$bpd|g" | sed 's/jpg/png/')

# If blurred version doesn't exist in specified folder, create it
if [[ ! -e $bl ]]; then
	echo "Creating blurred wallpaper"
	convert $bg -blur 0x6 $bl
fi

w="#83483b"
o="#24242c"
l="#24242c"

i3lock -i $bl -c '#000000' -w $w -o $o -l $l -e
